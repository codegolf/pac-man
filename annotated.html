<pre id=p><script>
l = "";
for (i in L = [
  a = 8191,                               // #############
  b = 4161,                               // #     #     #
  c = 5981,                               // # ### # ### #
  d = 5125,                               // # #       # #
  5493,                                   // # # # ### # #
  5397,                                   // # # #   # # #
  5589,                                   // # # ### # # #
  d,                                      // # #       # #
  c,                                      // # ### # ### #
  b,                                      // #     #     #
  a                                       // #############
]
) l += L[i]
  .toString(2)                            // convert to binary
  + 3;                                    // placeholder for \n

l = l.split(""),

w = 14,                                   // width
x = 76,                                   // players x position
X = 48,                                   // ghost x position

d =                                       // player direction
k =                                       // last keycode
D =                                       // ghost direction

setInterval(onkeydown = function(a) {

  k = a ? a.which - 38 : k;               // get key code

  if (
    !a &&                                 // skip on key press
    x ^ X                                 // check ghost and player collission
  ) for (

    l[x] = 2,                             // reset cell
    l[
      x += d = k + 1 >> 2 || 1 & l[       // update player direction
        x + (                             // update player position
          o =                             // calculate offset
            k % 2 ?                       // horizontal or vertical movement
              k  :                        // = horizontal
              k * w - w                   // = vertical
        )
      ] ? 1 & l[x + d] ? 0 : d : o        // detect wall collision
    ] = 4,                                // set player at new position
    l[X] &= 7,                            // remove ghost first

    b = D % 4,
    b = b % 2 ? b - 2 : b * w - w,        // calculate walking direction
    1 & l[X + b]                          // if walking into a wall
      ? D++                               // rotate ghost by 90 degree
      : X += b                            // else walk
      ,
      l[X] |= 8,                          // place ghost

      h = i = 0;
      153 > i;
  )
    h += ".# \no"                         // 0 = . = gold
                                          // 1 = # = wall
                                          // 2 =   = empty
                                          // 4 = o = player
                                          // 8 = x = ghost
                                          // 3 = \n placeholder
     [l[++i]]                             // get character
     || "x"                               // or place ghost


  p.innerHTML = h
}, 250)
</script>